@model PosEcommerce.Models.ItemModel
@using PosEcommerce.Models;
@{
    ViewBag.Title =@ViewBag.item.name;
}
    <section class="product-view p-0">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">

                            @if (@ViewBag.catPathList.Count == 0)
                            {
                                <li class="breadcrumb-item active" aria-current="page">@Global.resourcemanager.GetString("Products").ToString()</li>
                            }
                            else
                            {
                                <li class="breadcrumb-item"><a href="@Url.Action("Index", "Category")">@Global.resourcemanager.GetString("Products").ToString()</a></li>

                            }

                            @foreach (var row in ViewBag.catPathList)
                            {
                                if (@row.notes == "last")
                                {
                                    <li class="breadcrumb-item active" aria-current="page">@row.name</li>
                                }
                                else
                                {
                                    <li class="breadcrumb-item"><a href="@Url.Action("Index", "Category", new { catId = @row.categoryId })">@row.name</a></li>

                                }
                            }

                        </ol>
                    </nav>
                </div>
                <div class="col-md-6">
                    <div class="img-container">
                        <img src="
                              @if (ViewBag.item.image != "" && ViewBag.item.image != null)
                              {
                           @Url.Content(Global.APIUriserver + "images/item/" + ViewBag.item.image.ToString())
                              } else
                              {
                                  @Url.Content(Global.ItemFolder + "default.png")
                              }" alt="">
                    </div>
                </div>
                <div class="col-md-6 mb-5">
                    <h3>@ViewBag.item.name</h3>
                    <p class="product-features">@ViewBag.item.details</p>
                    <hr>
                    <form action="">
                        <div class="form-group">
                            <label for="exampleFormControlSelect1" class="font-weight-bold">Color</label>
                            <select class="form-control" id="exampleFormControlSelect1">
                                <option>White</option>
                                <option>Red</option>
                                <option>Blue</option>
                                <option>Green</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="exampleFormControlSelect1" class="font-weight-bold">Size</label>
                            <select class="form-control" id="exampleFormControlSelect1">
                                <option>S</option>
                                <option>M</option>
                                <option>Xl</option>
                                <option>XXL</option>
                            </select>
                        </div>
                        <p class="price">
                            <span class="title">@Global.resourcemanager.GetString("price").ToString(): </span>
                            @if (@ViewBag.item.isOffer == 1)
                            {
                                <span id="price" class="now" data-content="@ViewBag.item.disPrice">@ViewBag.item.disPrice</span><span class="now"> @Session["currency"]</span>
                                <span class="before">@ViewBag.item.price  @Session["currency"]</span>
                            }
                            else
                            {

                                <span class="now" id="price" data-content="@ViewBag.item.price">@ViewBag.item.price</span> <span class="now"> @Session["currency"]</span>
                            }
                        </p>

                        <div class="qty my-3">
                            <div class="row">
                                <div class="col-4">
                                    <form action="">
                                        <div class="input-group">
                                            <span class="input-group-btn">
                                                <button type="button" class="quantity-left-minus btn btn-dark btn-number" data-type="minus" data-field="">
                                                    <i class="fa fa-minus"></i>
                                                </button>
                                            </span>
                                            <input type="text" id="quantity" name="quantity" class="form-control input-number text-center" value="0" min="1" max="100">
                                            <span class="input-group-btn">
                                                <button type="button" class="quantity-right-plus btn btn-dark btn-number" data-type="plus" data-field="">
                                                    <i class="fa fa-plus"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <p class="total"><span>TOTAL: </span><span id="total"></span>@Session["currency"]</p>

                        <button type="button" class="btn btn-primary mb-3" id="add-cart" title="@Global.resourcemanager.GetString("AddtoCart").ToString()" @*onclick="addToCart(@Model.itemId)"*@><i class="fa fa-shopping-cart pl-2"></i>@Global.resourcemanager.GetString("AddtoCart").ToString()</button>

                        <div class="alert alert-danger" role="alert" style="display: none;">
                            This is a danger alert—check it out!
                        </div>
                        <div class="alert alert-success" role="alert" style="display: none;">
                            This is a success alert—check it out!
                        </div>
                    </form>  
                    <hr>
                    <div class="mt-3">
                        <a class="btn btn-dark btn-block" href="@Url.Action("CartView", "Cart")" title="@Global.resourcemanager.GetString("ViewCart").ToString()">@Global.resourcemanager.GetString("ViewCart").ToString()</a>
                        <a class="btn btn-outline-dark btn-block" href="#" title="@Global.resourcemanager.GetString("Checkout").ToString()">@Global.resourcemanager.GetString("Checkout").ToString()</a>
                    </div>

                </div>
                @*<div class="col-12 mb-5">
                    <h3>Properties</h3>
                    <hr>
                    <table class="table table-bordered">
                        <thead>
                        <tbody>
                            <tr>
                                <th scope="row">Colors</th>
                                <td>White, Blue, Red, Black</td>
                            </tr>
                            <tr>
                                <th scope="row">Size</th>
                                <td>Xl, L, M, S</td>
                            </tr>
                        </tbody>
                    </table>
                </div>*@

            </div>
        </div>
    </section>


    <script>
     

         
            function addToCart(_itemId) {
                var _quantity = $('#quantity').val();
                if (_quantity == "0")
                    displayAlert();
                else {
                    $.ajax({
                        url: '@Url.Action("AddWithQuantity", "Cart")',
                        data: JSON.stringify({
                            itemId: _itemId,
                            quantity: _quantity
                        }),
                        type: "POST",
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        async: true,
                        success: function (result) {
                            $('#span_cart_count').show();
                            $('#span_cart_count').html(result.cartCount);
                            $('#div-success-alert').fadeIn(300);
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            alert('oops, something bad happened');
                        }
                    });
                }

            }

            function displayAlert(e) {
                e.preventDefault();
                $(this).fadeIn(300).delay(2000).fadeOut(400);
            }

            var itemId =@ViewBag.item.itemId;
    
    </script>